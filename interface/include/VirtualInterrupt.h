#ifndef VIRTUALINTERRUPT_H
#define VIRTUALINTERRUPT_H


#define VI_MAXIMUM_ADDRESS 0b1111111
#define VI_MAXIMUM_VIRTUAL_INTERRUPTS 32


#include <stdint.h>


typedef void (*VirtualISR)();

enum InterruptAddress { // LSB trigger bit, MSB parity bit, MSB>>1 continuation bit
    VIRTUAL_INTERRUPT_01 = 0b00000000
    VIRTUAL_INTERRUPT_02 = 0b00000001
    VIRTUAL_INTERRUPT_03 = 0b00000010
    VIRTUAL_INTERRUPT_04 = 0b00000011
    VIRTUAL_INTERRUPT_05 = 0b00000100
    VIRTUAL_INTERRUPT_06 = 0b00000101
    VIRTUAL_INTERRUPT_07 = 0b00000110
    VIRTUAL_INTERRUPT_08 = 0b00000111
    VIRTUAL_INTERRUPT_09 = 0b00001000
    VIRTUAL_INTERRUPT_10 = 0b00001001
    VIRTUAL_INTERRUPT_11 = 0b00001010
    VIRTUAL_INTERRUPT_12 = 0b00001011
    VIRTUAL_INTERRUPT_13 = 0b00001100
    VIRTUAL_INTERRUPT_14 = 0b00001101
    VIRTUAL_INTERRUPT_15 = 0b00001110
    VIRTUAL_INTERRUPT_16 = 0b00001111
    VIRTUAL_INTERRUPT_17 = 0b00010000
    VIRTUAL_INTERRUPT_18 = 0b00010001
    VIRTUAL_INTERRUPT_19 = 0b00010010
    VIRTUAL_INTERRUPT_20 = 0b00010011
    VIRTUAL_INTERRUPT_21 = 0b00010100
    VIRTUAL_INTERRUPT_22 = 0b00010101
    VIRTUAL_INTERRUPT_23 = 0b00010110
    VIRTUAL_INTERRUPT_24 = 0b00010111
    VIRTUAL_INTERRUPT_25 = 0b00011000
    VIRTUAL_INTERRUPT_26 = 0b00011001
    VIRTUAL_INTERRUPT_27 = 0b00011010
    VIRTUAL_INTERRUPT_28 = 0b00011011
    VIRTUAL_INTERRUPT_29 = 0b00011100
    VIRTUAL_INTERRUPT_30 = 0b00011101
    VIRTUAL_INTERRUPT_31 = 0b00011110
    VIRTUAL_INTERRUPT_32 = 0b00011111
    VIRTUAL_INTERRUPT_33 = 0b00100000
    VIRTUAL_INTERRUPT_34 = 0b00100001
    VIRTUAL_INTERRUPT_35 = 0b00100010
    VIRTUAL_INTERRUPT_36 = 0b00100011
    VIRTUAL_INTERRUPT_37 = 0b00100100
    VIRTUAL_INTERRUPT_38 = 0b00100101
    VIRTUAL_INTERRUPT_39 = 0b00100110
    VIRTUAL_INTERRUPT_40 = 0b00100111
    VIRTUAL_INTERRUPT_41 = 0b00101000
    VIRTUAL_INTERRUPT_42 = 0b00101001
    VIRTUAL_INTERRUPT_43 = 0b00101010
    VIRTUAL_INTERRUPT_44 = 0b00101011
    VIRTUAL_INTERRUPT_45 = 0b00101100
    VIRTUAL_INTERRUPT_46 = 0b00101101
    VIRTUAL_INTERRUPT_47 = 0b00101110
    VIRTUAL_INTERRUPT_48 = 0b00101111
    VIRTUAL_INTERRUPT_49 = 0b00110000
    VIRTUAL_INTERRUPT_50 = 0b00110001
    VIRTUAL_INTERRUPT_51 = 0b00110010
    VIRTUAL_INTERRUPT_52 = 0b00110011
    VIRTUAL_INTERRUPT_53 = 0b00110100
    VIRTUAL_INTERRUPT_54 = 0b00110101
    VIRTUAL_INTERRUPT_55 = 0b00110110
    VIRTUAL_INTERRUPT_56 = 0b00110111
    VIRTUAL_INTERRUPT_57 = 0b00111000
    VIRTUAL_INTERRUPT_58 = 0b00111001
    VIRTUAL_INTERRUPT_59 = 0b00111010
    VIRTUAL_INTERRUPT_60 = 0b00111011
    VIRTUAL_INTERRUPT_61 = 0b00111100
    VIRTUAL_INTERRUPT_62 = 0b00111101
    VIRTUAL_INTERRUPT_63 = 0b00111110
    VIRTUAL_INTERRUPT_64 = 0b00111111
};

typedef struct VirtualInterrupt {
    int initialized = 0;
    int immutable = 0;
    int enabled = 0;
    enum InterruptAddress address;
    VirtualISR isr;
} VirtualInterrupt;

VirtualInterrupt instantiate_interrupt(enum InterruptAddress address);

void VITimerInterruptRead();

#endif

